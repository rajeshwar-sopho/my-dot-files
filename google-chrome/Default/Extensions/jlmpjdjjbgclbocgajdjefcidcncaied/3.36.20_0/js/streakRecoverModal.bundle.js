"use strict";(self.webpackChunkextension=self.webpackChunkextension||[]).push([[6678],{95412:(e,t,r)=>{r.d(t,{S:()=>p});var a=r(7527),n=r(75087),o=r(22155),s=r(30395),c=r.n(s),l=r(36780),i=r(52788),u=["name","checked","children","className","checkmarkClassName","onToggleCallback","id","disabled","defaultChecked"],d=o.createElement,p=(0,o.forwardRef)((function(e,t){var r=e.name,s=e.checked,p=e.children,k=e.className,v=e.checkmarkClassName,b=e.onToggleCallback,f=e.id,h=void 0===f?"":f,m=e.disabled,y=e.defaultChecked,g=(0,n.A)(e,u),x=(0,o.useState)(null!=s?s:y),w=x[0],R=x[1],C=(0,o.useId)(),A=h.concat(C);(0,o.useEffect)((function(){R(null!=s?s:y)}),[s,y]);return d("label",{className:c()("relative z-1 inline-flex select-none items-center p-1 pr-3 text-text-tertiary typo-footnote",!m&&"cursor-pointer",i.A.label,k,{checked:w,disabled:m}),style:{transition:"color 0.1s linear"},htmlFor:A},d("input",(0,a.A)({"aria-labelledby":"label-span-".concat(C),checked:s,defaultChecked:y,className:"absolute h-0 w-0 opacity-0","data-testid":"checkbox-input",disabled:m,id:A,name:r,onChange:function(e){R(e.target.checked),null==b||b(e.target.checked)},ref:t,type:"checkbox"},g)),d("div",{"aria-checked":s,"aria-labelledby":"label-".concat(C),className:c()("relative z-1 mr-3 flex h-5 w-5 items-center justify-center rounded-6 border-2 border-border-subtlest-primary",i.A.checkmark,v),role:"checkbox"},d(l.w,{"aria-hidden":!0,className:"icon h-full w-full text-text-primary opacity-0",role:"presentation",style:{transition:"opacity 0.1s linear"}})),d("span",{className:"min-w-0 flex-1",id:"label-span-".concat(C)},p))}))},33877:(e,t,r)=>{r.r(t),r.d(t,{StreakRecoverModal:()=>Y,StreakRecoverOptout:()=>W,default:()=>G});var a=r(7527),n=r(75087),o=r(22155),s=r(77955),c=r(89113),l=r(94198),i=r(67380),u=r(53823),d=r(83448),p=r(76800),k=r(54883),v=r(25150),b=r(97838),f=r(50122),h=r(89338),m=r(98093),y=r(2827),g=r.n(y),x=r(69918),w=r(5947),R=r(14243),C=r(9487),A=r(70038),O=r(9495),N=r(42104),S=r(30530),j=r(71623),F=r(36899),L=r(68392),D=r(61663),q=r(57952),E=r(82422),P=r(80244),U=r(58466);function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){(0,f.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var B=function(e){var t,r,a=e.onAfterClose,n=e.onRequestClose,s=(0,O.d)(),c=s.isActionsFetched,l=s.completeAction,i=s.checkHasCompleted,u=(0,A.e)(!1),d=(0,m.A)(u,2),p=d[0],k=d[1],v=(0,L.mu)().displayToast,b=(0,D.DX)().logEvent,f=(0,E.g0)().updateAlerts,y=(0,P.Z2)().user,_=(0,U.G)().isStreaksEnabled,B=(0,x.jE)(),T=(0,C.useRouter)().query.streak_restore,K=(0,w.n)({mutationKey:(0,S.$h)(S.jZ.UserStreakRecover),mutationFn:(t=(0,h.A)(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.e.request(N.qy).then((function(e){return e.recoverStreak}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)}),onSuccess:function(){b({event_name:q.VB.StreakRecover}),B.invalidateQueries({queryKey:(0,S.$h)(S.jZ.UserStreak,y)})}}),I=(0,o.useCallback)((0,h.A)(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f({showRecoverStreak:!1});case 2:case"end":return e.stop()}}),e)}))),[f]),H=(0,R.I)({queryKey:(0,S.$h)(S.jZ.UserStreakRecover),queryFn:(r=(0,h.A)(g().mark((function e(){var t,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.e.request(N.Vg);case 2:if(null!=(r=e.sent)&&null!==(t=r.streakRecover)&&void 0!==t&&t.canRecover||!T){e.next=10;break}return e.next=7,I();case 7:v("Oops, you are no longer eligible to restore your streak"),null==n||n(),null==a||a();case 10:return e.abrupt("return",r);case 11:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)}),enabled:!!y&&_&&!p}),M=H.data,V=H.isLoading,X=(0,o.useCallback)((0,h.A)(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p){e.next=4;break}return e.next=3,l(j.X2.DisableReadingStreakRecover);case 3:b({event_name:q.VB.DismissStreakRecover});case 4:return e.next=6,I();case 6:null==n||n(),null==a||a();case 8:case"end":return e.stop()}}),e)}))),[l,p,I,b,a,n]),Z=(0,o.useCallback)((0,h.A)(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K.mutateAsync();case 3:v("Lucky you! Your streak has been restored"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),v("Oops! We are unable to recover your streak. Could you try again later?");case 9:return e.next=11,null==X?void 0:X();case 11:case"end":return e.stop()}}),e,null,[[0,6]])}))),[v,X,K]),$=!c||i(j.X2.DisableReadingStreakRecover);return(0,o.useEffect)((function(){var e;null==M||null===(e=M.streakRecover)||void 0===e||!e.canRecover||$||V||b({event_name:q.VB.Impression,target_type:q.yK.StreakRecover,target_id:"restore streak"})}),[null==M?void 0:M.streakRecover,$,V,b]),{hideForever:{isChecked:p,toggle:k},onClose:X,onRecover:Z,recover:z(z({},null==M?void 0:M.streakRecover),{},{isLoading:V,isDisabled:$})}};var T=r(95412),K=r(74689),I=r(16763),H=["cost"],M=o.createElement,V=function(){return M("div",{className:"overflow-hidden tablet:-mx-4",role:"presentation","aria-hidden":!0},M("img",{alt:"Broken reading streak",className:"h-auto w-full object-contain",loading:"lazy",src:I.R4}))},X=function(e){var t=e.days;return M(i.o5,{className:"-mx-1 -mb-1 text-center font-bold",tag:i.UL.H3,type:i.kR.Title1,"data-testid":"streak-recover-modal-heading"},"Oh no! Your",M("span",{className:"text-accent-bacon-default"}," ",t," day streak ")," has been broken!")},Z=function(e){var t=e.reputation,r=e.cost,a=0===r,n=t>=r,s=M("a",{target:"_blank",rel:p.O8,href:k.Wn,title:"What are reputation points?",className:"text-text-link hover:underline"},"reputation points"),c=M(o.Fragment,null,"Lucky you! The first streak restore is on us 🎁. This usually costs 25"," ",s,". Be sure to come prepared next time!"),l=M(o.Fragment,null,"Maintain your streak!",M("br",null),"Use ",r," ",s," to keep going."),u=M(o.Fragment,null,"You don’t have enough ",s," to restore your streaks.");return M(i.o5,{className:"text-center",tag:i.UL.P,type:i.kR.Body,"data-testid":"streak-recovery-copy"},a&&c,!a&&(n?l:u))},$=function(e){var t=e.cost,r=(0,n.A)(e,H);return M(u.$n,(0,a.A)({},r,{className:"relative",variant:d.Ak.Primary,size:d.Mp.Large,"data-testid":"streak-recover-button"}),"Restore my streak",M("span",{className:"absolute -right-0.5 -top-0.5 flex items-center whitespace-nowrap rounded-bl-14 rounded-tr-14 bg-accent-onion-default px-1.5 py-1 text-text-primary"},M(i.o5,{tag:i.UL.Span,type:i.kR.Caption1,"data-testid":"streak-recovery-cost"},t," Rep")," ",M(v.H,{className:"inline-block",size:b.lK.Size16})))},W=function(e){var t=e.hideForever,r=e.id;return M("div",{className:"flex flex-row items-center justify-center"},M(T.S,{"aria-labelledby":"showAgain-label-".concat(r),checked:t.isChecked,className:"!pr-0","data-testid":"streak-recover-optout",id:"showAgain-".concat(r),name:"showAgain",onToggleCallback:t.toggle}),M(i.o5,{"aria-label":"Never show 'reading streak recover' popup again",className:"cursor-pointer py-2.5 text-text-tertiary",htmlFor:"showAgain-".concat(r),id:"showAgain-label-".concat(r),tag:i.UL.Label,type:i.kR.Footnote},"Never show this again"))},Y=function(e){var t=e.isOpen,r=e.onRequestClose,a=e.onAfterClose,n=e.user,i=(0,U.G)().isStreaksEnabled,u=(0,o.useId)(),d=B({onAfterClose:a,onRequestClose:r}),p=d.recover,k=d.hideForever,v=d.onClose,b=d.onRecover;if(!n||!i||!p.canRecover||p.isLoading||p.isDisabled)return null;var f=n.reputation,h=f>=p.cost;return M(l.aF,{isOpen:t,isDrawerOnMobile:t,onRequestClose:v,size:s.rI.XSmall},M(K.O,{"aria-label":"Close streak recover popup",onClick:v,title:"Close streak recover popup"}),M(c.c,{className:"!p-4"},M("div",{className:"flex flex-col gap-4"},M(V,null),M(X,{days:p.oldStreakLength}),M(Z,{reputation:f,cost:p.cost}),h&&M($,{onClick:b,cost:p.cost}),M(W,{id:u,hideForever:k}))))};const G=Y},52788:(e,t,r)=>{r.d(t,{A:()=>a});const a={checkmark:"Ur6sCRLeLJ0xiAl0Ry8kcA==",label:"_0ta8J6BOiKQx6kRDDsqEHg=="}}}]);