(self.webpackChunkextension=self.webpackChunkextension||[]).push([[8440],{85057:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>P});var r=n(7527),a=n(22155),i=n(36797),o=n.n(i),l=n(94198),u=n(68390),c=n(72046),d=n(72870),s=n(74689),v=n(89883),m=n(89010),f=n(65323),p=n(61663),b=n(57952),g=n(77955),y=a.createElement,C=o()((function(){return n.e(1394).then(n.bind(n,3059))}),{loadableGenerated:{webpack:function(){return[3059]}}}),h=o()((function(){return Promise.all([n.e(9536),n.e(1278)]).then(n.bind(n,11386))}),{loadableGenerated:{webpack:function(){return[11386]}}}),k=o()((function(){return Promise.all([n.e(9536),n.e(6656)]).then(n.bind(n,9447))}),{loadableGenerated:{webpack:function(){return[9447]}}});const P=function(e){var t=(0,c.o)(),n=t.getMarketingCta,a=t.clearMarketingCta,i=n(f.WA.Plus).campaignId,o=(0,p.DX)().logEvent,P=(0,v.d)().closeModal,_=(0,u.oX)(),E=function(){o({event_name:b.VB.MarketingCtaDismiss,target_type:b.yK.MarketingCtaPlus,target_id:i}),a(i),P()};return(0,d.G6)(d.bh.Tablet)?y(m.Pr,null,y(l.aF,(0,r.A)({size:g.rI.XLarge,className:"flex-1 overflow-x-hidden !bg-background-default"},e,{onRequestClose:E}),y(l.aF.Body,{className:"!p-0"},y(s.O,{onClick:E,top:"4"}),y(_?h:k,null)))):y(C,(0,r.A)({onClose:E},e))}},89010:(e,t,n)=>{"use strict";n.d(t,{Pr:()=>O,P5:()=>I});var r=n(50122),a=n(89338),i=n(2827),o=n.n(i),l=n(22155),u=n(63982),c=n(14243),d=n(9487),s=n(80244),v=n(54883),m=n(57952),f=n(92315),p=n(55551),b=n(16354),g=n(81602),y=n(62424),C=n(68390),h=(0,l.createContext)({trackSignup:function(){},trackPayment:function(){},trackEvent:function(){}}),k=l.createElement;function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=l.createContext(void 0);var O=function(e){var t=e.children,n=(0,d.useRouter)(),r=(0,s.Z2)(),i=r.user,P=r.geo,O=r.isValidRegion,I=(0,l.useContext)(h).trackPayment,w=(0,y.iT)(p.N4.pricingIds),T=(0,l.useState)(),M=T[0],D=T[1],N=(0,f.L)(),j=N.logSubscriptionEvent,S=N.isPlus,x=(0,l.useRef)();x.current=j,(0,l.useEffect)((function(){if(!(0,C.oX)()){var e=(0,u.getPaddleInstance)();e?D(e):(0,u.initializePaddle)({environment:"MISSING_ENV_VAR".NEXT_PUBLIC_PADDLE_ENVIRONMENT||"production",token:"topsecret",eventCallback:function(e){var t,r,a,i;switch(null==e?void 0:e.name){case u.CheckoutEventNames.CHECKOUT_PAYMENT_SELECTED:x.current({event_name:m.VB.SelectCheckoutPayment,target_id:null==e||null===(t=e.data)||void 0===t?void 0:t.payment.method_details.type});break;case u.CheckoutEventNames.CHECKOUT_COMPLETED:x.current({event_name:"gifter_id"in e.data.custom_data?m.VB.CompleteGiftCheckout:m.VB.CompleteCheckout,extra:{user_id:"gifter_id"in e.data.custom_data&&"user_id"in e.data.custom_data?e.data.custom_data.user_id:void 0,cycle:null!==(r=null==e||null===(a=e.data.items)||void 0===a||null===(a=a[0])||void 0===a||null===(a=a.billing_cycle)||void 0===a?void 0:a.interval)&&void 0!==r?r:"one-off",localCost:null==e?void 0:e.data.totals.total,localCurrenct:null==e?void 0:e.data.currency_code,payment:null==e?void 0:e.data.payment.method_details.type}}),I(null==e?void 0:e.data.totals.total,null==e?void 0:e.data.currency_code,null==e||null===(i=e.data)||void 0===i?void 0:i.transaction_id),n.push(v.j$);break;case"checkout.warning":x.current({event_name:m.VB.WarningCheckout});break;case u.CheckoutEventNames.CHECKOUT_ERROR:x.current({event_name:m.VB.ErrorCheckout})}}}).then((function(e){e&&D(e)}))}}),[n,I]);var A=(0,l.useCallback)((0,a.A)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null==M?void 0:M.PricePreview({items:Object.keys(w).map((function(e){return{priceId:e,quantity:1}})),address:(null==P?void 0:P.region)&&{countryCode:P.region}}));case 1:case"end":return e.stop()}}),e)}))),[M,w,null==P?void 0:P.region]),L=(0,c.I)({queryKey:["productPrices",i,w],queryFn:A,enabled:!!(M&&w&&P&&i)}),V=L.data,R=L.isLoading,q=(0,l.useMemo)((function(){var e,t,n,r,a=new Intl.NumberFormat(null!==(e=null===globalThis||void 0===globalThis||null===(t=globalThis.navigator)||void 0===t?void 0:t.language)&&void 0!==e?e:"en-US",{minimumFractionDigits:2});return null!==(n=null==V||null===(r=V.data)||void 0===r||null===(r=r.details)||void 0===r||null===(r=r.lineItems)||void 0===r?void 0:r.map((function(e){var t,n,r,i,o,l=!(null!==(t=e.price)&&void 0!==t&&null!==(t=t.billingCycle)&&void 0!==t&&t.interval),u="year"===(null===(n=e.price)||void 0===n||null===(n=n.billingCycle)||void 0===n?void 0:n.interval),c=l||u?b.qf.Yearly:b.qf.Monthly,d=(0,g.y8)(e),s=c===b.qf.Yearly?12:1,v=Number((d/s).toString().match(/^-?\d+(?:\.\d{0,2})?/)[0]),m=null==V?void 0:V.data.currencyCode,f=e.formattedTotals.total.replace(/\d|\.|\s|,/g,"");return{label:e.price.name,value:e.price.id,price:{amount:d,formatted:e.formattedTotals.total,monthlyAmount:v,monthlyFormatted:"".concat(f).concat(a.format(v))},currencyCode:m,currencySymbol:f,extraLabel:null===(r=e.price.customData)||void 0===r?void 0:r.label,appsId:null!==(i=null===(o=e.price.customData)||void 0===o?void 0:o.appsId)&&void 0!==i?i:b.lL.Default,duration:c,trialPeriod:e.price.trialPeriod}})))&&void 0!==n?n:[]}),[null==V?void 0:V.data]),B=(0,l.useMemo)((function(){var e;return null===(e=q.find((function(e){return e.appsId===b.lL.EarlyAdopter})))||void 0===e?void 0:e.value}),[q]),F=(0,l.useMemo)((function(){return q.find((function(e){return e.appsId===b.lL.GiftOneYear}))}),[q]),G=(0,l.useMemo)((function(){return q.some((function(e){return!!e.trialPeriod}))}),[q]),U=(0,l.useCallback)((function(e){var t=e.priceId,n=e.giftToUserId;S&&t!==(null==F?void 0:F.value)||O&&(null==M||M.Checkout.open({items:[{priceId:t,quantity:1}],customer:{email:null==i?void 0:i.email},customData:_({user_id:null!=n?n:null==i?void 0:i.id},!!n&&{gifter_id:null==i?void 0:i.id}),settings:{displayMode:"inline",frameTarget:"checkout-container",frameInitialHeight:500,frameStyle:"width: 100%; background-color: transparent; border: none;",theme:"dark"}}))}),[null==F?void 0:F.value,S,O,null==M?void 0:M.Checkout,null==i?void 0:i.email,null==i?void 0:i.id]),K=(0,l.useMemo)((function(){return{openCheckout:U,paddle:M,productOptions:q.filter((function(e){return e.value!==(null==F?void 0:F.value)})),earlyAdopterPlanId:B,isPlusAvailable:O,giftOneYear:F,isPricesPending:R,isFreeTrialExperiment:G}}),[F,B,U,M,q,O,R,G]);return k(E.Provider,{value:K},t)},I=function(){return(0,l.useContext)(E)}},63982:()=>{}}]);