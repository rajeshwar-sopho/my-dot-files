"use strict";(self.webpackChunkextension=self.webpackChunkextension||[]).push([[3349],{92339:(e,t,n)=>{n.r(t),n.d(t,{CreateSharedPostModal:()=>O,default:()=>j});var r=n(7527),o=n(98093),a=n(75087),i=n(22155),s=n(94198),l=n(24481),u=n(63606),c=n(92975),d=n(78515),p=n(53823),m=n(83448),f=n(19505),v=n(99277),h=n(52303),y=n(16714),b=n(58392),w=n(17398),g=n(10663),P=n(57434),S=n(68334),x=n(38638),k=["preview","squad","onSharedSuccessfully","onRequestClose"],A=i.createElement;function O(e){var t,n,O,j=e.preview,N=e.squad,E=e.onSharedSuccessfully,F=e.onRequestClose,C=(0,a.A)(e,k),I=(0,i.useRef)(),D=(0,i.useState)(null!==(t=null!==(n=null==j?void 0:j.permalink)&&void 0!==n?n:null==j?void 0:j.url)&&void 0!==t?t:""),M=D[0],L=D[1],q=(0,P.$)(),_=q.shouldShowCta,T=q.isEnabled,U=q.onToggle,z=q.onSubmitted,R=function(){null==E||E(),z(),F(null)},X=(0,d.h)({initialPreview:j,onPostSuccess:R,onSourcePostModerationSuccess:R}),G=X.getLinkPreview,Y=X.isLoadingPreview,$=X.preview,W=X.isPosting,B=X.onSubmitPost,K=[null==$?void 0:$.url,null==$?void 0:$.permalink],H=(0,g.U)(G,(function(e){return K.every((function(t){return t!==e}))})),J=(0,o.A)(H,1)[0],Q=A(i.Fragment,null,A(p.$n,{icon:A(v.X,null),size:m.Mp.Small,variant:m.Ak.Tertiary,onClick:null==I||null===(O=I.current)||void 0===O?void 0:O.onMentionCommand}),A(h.c,{vertical:!0}),A(b.A,{source:N,size:x.Ov.Small}),A("span",{className:"-ml-1 flex-1"},A("strong",null,N.name),A("span",{className:"ml-1 text-text-tertiary"},"@",N.handle))),Z={color:f.h.Cabbage,variant:m.Ak.Primary,disabled:W,loading:W};return A(s.aF,(0,r.A)({kind:s.aF.Kind.FlexibleCenter,size:s.aF.Size.Medium,onRequestClose:F},C,{formProps:{form:"share_post",title:"New post",rightButtonProps:Z,copy:{right:"Post"}}}),A(s.aF.Header,{title:"New post"}),A("form",{className:"flex w-full flex-col p-3",action:"#",onSubmit:function(e){e.preventDefault();var t=(0,w.Y)(e.currentTarget).commentary;return B(e,N,t)},id:"share_post"},A(l.A,{ref:I,showUserAvatar:!0,textareaProps:{rows:5,name:"commentary"},sourceId:null==N?void 0:N.id,allowPreview:!1,enabledCommand:{mention:!0},footer:Y?A(u.j,{link:M,className:"m-3 flex-col-reverse"}):A(c.A,{className:"m-3 !w-auto flex-col-reverse",preview:null!=$?$:j,link:M,onLinkChange:function(e){var t=e.currentTarget.value;L(t),J(t)}})}),_&&A(S.d,{"data-testid":"push_notification-switch",inputId:"push_notification-switch",name:"push_notification",labelClassName:"flex-1 font-normal",className:"py-3",compact:!1,checked:T,onToggle:U},"Receive updates whenever your Squad members engage with your post")),A("span",{className:"flex flex-row items-center gap-2 px-4 tablet:hidden"},Q),A(s.aF.Footer,{className:"typo-caption1",justify:y.F1.Start},Q,A(p.$n,(0,r.A)({},Z,{className:"ml-auto",form:"share_post"}),"Post")))}const j=O},92975:(e,t,n)=>{n.d(t,{A:()=>f});var r=n(22155),o=n(43660),a=n(26540),i=n(75240),s=n(69069),l=n(41536),u=n(75737),c=n(53823),d=n(83448),p=n(38638),m=r.createElement;function f(e){var t,n,r=e.link,f=e.preview,v=e.onLinkChange,h=e.className,y=e.isMinimized,b=e.showPreviewLink,w=void 0===b||b;return m(u.rA,{className:h},w&&m(o.A,{leftIcon:m(a.q,null),label:"URL",type:"url",name:"url",inputId:"preview_url",fieldType:"tertiary",className:{container:"w-full"},value:r,onInput:v}),f.title&&f.image&&m(u.rP,{className:y&&"!px-3 !py-2"},m("div",{className:"flex flex-1 flex-col typo-footnote"},m("span",{className:"line-clamp-2 font-bold"},f.title),"unknown"!==(null===(t=f.source)||void 0===t?void 0:t.id)&&(y?m(s.J,{size:p.Ov.Small,source:f.source,className:"absolute right-24 mr-4 mt-1"}):m("span",{className:"mt-1 flex flex-row items-center"},m(s.J,{size:p.Ov.Small,source:f.source}),m("span",{className:"text-text-tertiary"},null===(n=f.source)||void 0===n?void 0:n.name)))),m(l._V,{className:u.Gs,src:f.image,alt:"".concat(f.title)}),!y&&m(c.$n,{icon:m(i.S,null),variant:d.Ak.Tertiary,type:"button",tag:"a",target:"_blank",rel:"noopener noreferrer",href:r})))}},63606:(e,t,n)=>{n.d(t,{j:()=>p});var r=n(22155),o=n(43660),a=n(30794),i=n(9062),s=n(75240),l=n(75737),u=n(53823),c=n(83448),d=r.createElement;function p(e){var t=e.link,n=e.className;return d(l.rA,{className:n},d(o.A,{leftIcon:d(a.a,{className:"mr-2"}),label:"URL",type:"url",inputId:"preview_url",fieldType:"tertiary",className:{container:"w-full"},value:t}),d(l.rP,null,d("span",{className:"absolute left-2 top-2 text-text-quaternary typo-caption1"},"Fetching preview, please hold..."),d("div",{className:"flex flex-1 flex-col typo-footnote"},d("div",{className:"flex-flex-col relative"},d(i._,{className:"h-2 w-5/6 rounded-12"}),d(i._,{className:"mt-3 h-2 w-1/2 rounded-12"}))),d("div",{className:l.Gs}),d(u.$n,{variant:c.Ak.Tertiary,icon:d(s.S,null),disabled:!0,type:"button",tag:"a",target:"_blank",rel:"noopener noreferrer",href:t})))}},75737:(e,t,n)=>{n.d(t,{Gs:()=>a,rA:()=>i,rP:()=>s});var r=n(63423),o=n(16714),a="w-28 h-16 rounded-12 bg-text-disabled object-cover",i=(0,r.A)(o.wt,"rounded-16 border border-border-subtlest-tertiary"),s=(0,r.A)(o.Ye,"relative gap-3 items-center py-5 px-4")},7186:(e,t,n)=>{n.d(t,{$d:()=>h,D4:()=>w,Eh:()=>b,jG:()=>g,wF:()=>y});var r=n(50122),o=n(22155),a=n(63423),i=n(67380),s=n(16714),l=n(87822),u=n(48191),c=n(97838),d=n(77955),p=n(48389),m=o.createElement;function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=function(e){var t=e.children,n=e.className;return m(i.o5,{className:n,tag:i.UL.H1,type:i.kR.LargeTitle,bold:!0},t)},y=(0,a.A)("span","text-brand-default"),b=((0,a.A)(s.mf,"!p-0 laptop:min-h-page h-full !max-w-[42.5rem] !w-full",s.hC),(0,a.A)("div","flex flex-1 flex-col"),function(e){return(null==e?void 0:e.moderationRequired)&&!(0,p.pZ)(e,l.Wk.ModeratePost)}),w={title:"Your post has been submitted for review",description:"Your post is now waiting for the admin's approval. We'll notify you once it's been reviewed.",okButton:{title:"Got it",className:"tablet:w-full"},cancelButton:null,promptSize:d.rI.XSmall,icon:m(u.x,{size:c.lK.XXXLarge})},g=v(v({},w),{},{title:"Your edit has been submitted for review",description:"Your edit is now waiting for the admin’s approval. We’ll notify you once it’s been reviewed."})},10663:(e,t,n)=>{n.d(t,{U:()=>a});var r=n(34229),o=n(70591),a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;return(0,r.A)((function(n){return(0,o.U8)(n)&&t(n)?e(n):null}),n)}},86735:(e,t,n)=>{n.d(t,{A:()=>c});var r=n(89338),o=n(2827),a=n.n(o),i=n(5947),s=n(55059),l=n(27840),u=n(7186);const c=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=n.onSuccess,c=n.onError,d=n.onSettled,p=n.onMutate,m=(0,l.k)().showPrompt,f=(0,i.n)({mutationFn:s.o8,onSuccess:(e=(0,r.A)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(t.post?u.jG:u.D4);case 2:null==o||o(t);case 3:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)}),onError:c,onSettled:d,onMutate:p}),v=f.mutateAsync,h=f.isPending,y=f.isSuccess,b=(0,i.n)({mutationFn:s.$Y,onSuccess:(t=(0,r.A)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(u.jG);case 2:null==o||o(t);case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)}),onError:c,onSettled:d,onMutate:p}),w=b.mutateAsync,g=b.isPending,P=b.isSuccess;return{onCreatePostModeration:v,onUpdatePostModeration:w,isPending:h||g,isSuccess:y||P}}},78515:(e,t,n)=>{n.d(t,{h:()=>S});var r=n(89338),o=n(50122),a=n(2827),i=n.n(a),s=n(69918),l=n(5947),u=n(22155),c=n(55059),d=n(36899),p=n(68392),m=n(48389),f=n(71623),v=n(80244),h=n(9495),y=n(91201),b=n(86735),w=n(7186);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,o.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onPostSuccess,n=e.onMutate,o=e.onError,a=e.onExternalLinkSuccess,g=e.onSourcePostModerationSuccess,S=e.initialPreview,x=(0,p.mu)().displayToast,k=(0,v.Z2)().user,A=(0,s.jE)(),O=(0,h.d)().completeAction,j=(0,u.useState)(S),N=j[0],E=j[1],F=(0,y.D)().requestMethod,C=(0,l.n)({mutationFn:c.pD,onMutate:n,onError:o,onSuccess:t}),I=C.mutateAsync,D=C.isPending,M=C.isSuccess,L=(0,l.n)({mutationFn:c.lD,onMutate:n,onSuccess:t,onError:o}),q=L.mutateAsync,_=L.isPending,T=L.isSuccess,U=(0,l.n)({mutationFn:function(e){return(0,c.e_)(e,F)},onSuccess:function(e,t){E(P(P({},e),{},{url:t})),null==a||a(e,t)},onError:function(e){var t,n=(0,d.Pd)(e,d.hD.RateLimited),r=null!==(t=null==n?void 0:n.message)&&void 0!==t?t:d.XW;x(r),null==o||o(e)}}),z=U.mutateAsync,R=U.isPending,X=(0,b.A)({onSuccess:function(e){O(f.X2.SquadFirstPost),null==g||g(e)},onError:function(){x(d.XW)}}),G=X.onCreatePostModeration,Y=X.isSuccess,$=X.isPending,W=(0,u.useCallback)(function(){var e=(0,r.A)(i().mark((function e(t,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!_&&!T){e.next=2;break}return e.abrupt("return",null);case 2:return(0,w.Eh)(n)?G(P(P({},t),{},{type:c.xj.Freeform,postId:t.id,sourceId:n.id})):q(t),e.abrupt("return",null);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[q,G,_,T]),B=function(){var e=(0,r.A)(i().mark((function e(){var t=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(t.length>0&&void 0!==t[0]&&t[0]?"The post has been updated":"This post has been shared to your squad"),e.next=4,A.invalidateQueries({queryKey:["sourceFeed",k.id]});case 4:O(f.X2.SquadFirstPost);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=(0,l.n)({mutationFn:(0,m.DC)(F),onSuccess:function(e){B(),t&&t(e,null==e?void 0:e.permalink)}}),H=K.mutateAsync,J=K.isPending,Q=K.isSuccess,Z=(0,l.n)({mutationFn:(0,m.Qz)(F),onSuccess:function(e){B(!0),t&&t(e,null==e?void 0:e.permalink)}}),V=Z.mutateAsync,ee=Z.isPending,te=Z.isSuccess,ne=(0,l.n)({mutationFn:function(e){return(0,c.w)(e,F)},onSuccess:function(e,n){var r=n.url;B(),t&&t(null,r)}}),re=ne.mutateAsync,oe=ne.isPending,ae=ne.isSuccess,ie=J||oe||$||_||D,se=te||ee||$,le=Y||Q||ae||M||T,ue=(0,u.useCallback)((function(e,t,n){if(null==e||e.preventDefault(),ie)return null;if(N.id)return(0,w.Eh)(t)?G({type:c.xj.Share,sourceId:t.id,sharedPostId:N.id,title:n}):H({id:N.id,sourceId:t.id,commentary:n});var r=N.title,o=N.image,a=N.url;return r?(0,w.Eh)(t)?G({externalLink:a,title:r,imageUrl:o,type:c.xj.Share,sourceId:t.id,content:n}):re({url:a,title:r,image:o,sourceId:t.id,commentary:n}):(x("Invalid link"),null)}),[N,x,re,H,ie,G]),ce=(0,u.useCallback)((function(e,t,n,r){return e.preventDefault(),se?null:(0,w.Eh)(r)?G({postId:t,type:c.xj.Share,sourceId:r.id,title:n}):V({id:t,commentary:n})}),[V,se,G]),de=(0,u.useCallback)((function(e,t){return(0,w.Eh)(t)?G(P(P({},e),{},{sourceId:t.id,type:c.xj.Freeform})):I(P(P({},e),{},{sourceId:t.id})),null}),[I,G]);return{isLoadingPreview:R,getLinkPreview:z,onSubmitPost:ue,onUpdateSharePost:ce,isPosting:ie,onEditFreeformPost:W,preview:N,isSuccess:le,onSubmitFreeformPost:de,onUpdatePreview:E}}}}]);