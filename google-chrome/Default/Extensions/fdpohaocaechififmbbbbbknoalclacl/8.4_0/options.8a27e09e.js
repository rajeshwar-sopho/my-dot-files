function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},i={},a=n.parcelRequire60cc;null==a&&((a=function(e){if(e in r)return r[e].exports;if(e in i){var t=i[e];delete i[e];var n={id:e,exports:{}};return r[e]=n,t.call(n.exports,n,n.exports),n.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){i[e]=t},n.parcelRequire60cc=a),a.register("3A0PR",(function(t,n){e(t.exports,"ERROR_NAME",(()=>i)),e(t.exports,"getZoom",(()=>l)),e(t.exports,"captureVisibleTab",(()=>c)),e(t.exports,"isCaptureVisibleTabQuotaError",(()=>d)),e(t.exports,"sendMessage",(()=>u)),e(t.exports,"getCurrentTab",(()=>p)),e(t.exports,"openInTabs",(()=>h));var r=a("5dZ7N");const i="ChromeTabsError",o=(0,r.genLastErrorFmt)(i),s=(0,r.genWrapError)(i),l=e=>s(chrome.tabs.getZoom(e),"getZoom"),c=(e,t)=>s(chrome.tabs.captureVisibleTab(e,t),"captureVisibleTab"),d=e=>e&&"object"==typeof e&&e.name===i&&"captureVisibleTab"===e.via&&e.message&&-1!==e.message.indexOf("MAX_CAPTURE_VISIBLE_TAB_CALLS_PER_SECOND"),u=(e,t,n)=>new Promise(((i,a)=>{chrome.tabs.sendMessage(e,t,n,(e=>{const t=(0,r.getLastError)();return t?a(o(t,"sendMessage")):i(e)}))})),p=()=>{return(e={active:!0,currentWindow:!0},s(chrome.tabs.query(e),"query")).then((e=>e[0]));var e},h=async(e,t)=>{let n,r=t.length;const i=a=>{if(a>=t.length)return t;let o=t[a],l=a===r-1;return e.incognito&&0===a?(c={url:o,incognito:!1,focused:l},s(chrome.windows.create(c),"windowsCreate")).then((e=>(n=e.id,i(a+1)))):(e=>s(chrome.tabs.create(e),"create"))({url:o,active:l,windowId:n,openerTabId:e.id,index:(e.incognito?0:e.index)+1+a}).then((e=>i(a+1)));var c};return i(0)}}));var o=a("1Tjc3");a("2q4iO");var s=a("aHNfr"),l=a("h4XuO"),c=a("03QYZ");const d=()=>{const e=(0,c.getQueryString)(),t=e.id||e.oid,n=e.e,r=e.url;return{options:m(t,n,r),history:f(t,n,r),capture:t?p(t,r):void 0,editor:t&&n?h(t,n,r):void 0}},u=(e,t,n=!1)=>{if(e){-1===e.href.indexOf("?")&&(e.href=t,n&&e.setAttribute("style",""))}},p=(e,t=null)=>{const n={id:e};t&&(n.url=t);return"/capture.html"+("?"+(0,c.toQueryString)(n))},h=(e,t,n=null)=>{const r={id:e,e:t};n&&(r.url=n);return"/editor.html"+("?"+(0,c.toQueryString)(r))},m=(e=null,t=null,n=null)=>{let r="";if(e){const i={id:e};t&&(i.e=t),n&&(i.url=n),r="?"+(0,c.toQueryString)(i)}return"/options.html"+r},f=(e=null,t=null,n=null)=>{let r="";if(e){const i={oid:e};t&&(i.e=t),n&&(i.url=n),r="?"+(0,c.toQueryString)(i)}return"/capture.html"+r};o=a("1Tjc3");var g={};
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){var e={}.hasOwnProperty;function t(){for(var n=[],r=0;r<arguments.length;r++){var i=arguments[r];if(i){var a=typeof i;if("string"===a||"number"===a)n.push(i);else if(Array.isArray(i)&&i.length){var o=t.apply(null,i);o&&n.push(o)}else if("object"===a)for(var s in i)e.call(i,s)&&i[s]&&n.push(s)}}return n.join(" ")}g?(t.default=t,g=t):"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("classnames",[],(function(){return t})):window.classNames=t}();var v=a("2q4iO"),b=a("83PZf"),x=a("dk7YQ"),y=a("2auQc"),w=a("jmw9X"),j=(a("h4XuO"),a("iMjBX"));var E=a("cEw93"),S=a("aiU1O"),k=a("7i7LO");let N=null;const O=(e=!1)=>{if(null===N){const e=document.createElement("a");e.style.cssText="position: sticky;",N=-1!==e.style.position.indexOf("sticky")}return N&&e&&document.documentElement.classList.add("csspositionsticky"),N};var T=a("guJCW"),C=a("3ESIc"),R=(l=a("h4XuO"),a("2xkva"));S=a("aiU1O"),c=a("03QYZ");const L=(e,t)=>{let n,r,i=[];return e.forEach((e=>{e[t]!==r&&(void 0!==n&&i.push(n),r=e[t],n={key:r,vals:[]}),n.vals.push(e)})),n&&n.vals.length&&i.push(n),i},_=e=>{window.clearTimeout(_.timeoutId),(0,c.asArray)(document.querySelectorAll(".notif")).forEach((e=>e.classList.add("hide"))),(0,l.$)(e).classList.remove("hide"),_.timeoutId=window.setTimeout((()=>(0,l.$)(e).classList.add("hide")),2e3)};_.timeoutId=null;const q=async e=>{R.default.error("options error",e),await S.update(e);let t=I("div",{className:"error",textContent:"An error was encountered!  "}),n=(0,c.reportLink)(window.location.href,(0,c.errorToString)(e)),r=I("a",{className:"underline",target:"_blank",rel:"noopener noreferrer",href:n,textContent:"Report issue"});t.appendChild(r),F(),document.body.appendChild(t),window.scrollTo(0,0)},F=()=>{(0,c.asArray)(document.querySelectorAll("body > .error")).forEach((e=>{e.parentNode.removeChild(e)}))},I=(e,t)=>{let n=document.createElement(e);return t&&t.style&&(Object.assign(n.style,t.style),delete t.style),Object.assign(n,t),n},A=e=>{switch(e.type){case"checkbox":return e.checked;case"text":case"textarea":case"select-one":return e.value;default:throw new Error(`Unknown input type: ${e.type}`)}};o=a("1Tjc3");var M=a("cAnjR");v=a("2q4iO");function z(){return z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},z.apply(null,arguments)}function B(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}v=a("2q4iO"),v=a("2q4iO");var P=(v=a("2q4iO")).useLayoutEffect,$=function(e){var n=t(v).useRef(e);return P((function(){n.current=e})),n},W=(v=a("2q4iO"),function(e,t){"function"!=typeof e?e.current=t:e(t)}),H=function(e,n){var r=t(v).useRef();return t(v).useCallback((function(t){e.current=t,r.current&&W(r.current,null),r.current=n,n&&W(n,t)}),[n])},U={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},Q=function(e){Object.keys(U).forEach((function(t){e.style.setProperty(t,U[t],"important")}))},D=null,X=function(e,t){var n=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?n+t.borderSize:n-t.paddingSize};var V=function(){},Z=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],Y=!!document.documentElement.currentStyle,G=function(e){var t=window.getComputedStyle(e);if(null===t)return null;var n,r=(n=t,Z.reduce((function(e,t){return e[t]=n[t],e}),{})),i=r.boxSizing;return""===i?null:(Y&&"border-box"===i&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px"),{sizingStyle:r,paddingSize:parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),borderSize:parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth)})};function J(e,t,n){var r=$(n);v.useLayoutEffect((function(){var n=function(e){return r.current(e)};if(e)return e.addEventListener(t,n),function(){return e.removeEventListener(t,n)}}),[])}var K=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],ee=function(e,t){var n=e.cacheMeasurements,r=e.maxRows,i=e.minRows,a=e.onChange,o=void 0===a?V:a,s=e.onHeightChange,l=void 0===s?V:s,c=B(e,K),d=void 0!==c.value,u=v.useRef(null),p=H(u,t),h=v.useRef(0),m=v.useRef(),f=function(){var e=u.current,t=n&&m.current?m.current:G(e);if(t){m.current=t;var a=function(e,t,n,r){void 0===n&&(n=1),void 0===r&&(r=1/0),D||((D=document.createElement("textarea")).setAttribute("tabindex","-1"),D.setAttribute("aria-hidden","true"),Q(D)),null===D.parentNode&&document.body.appendChild(D);var i=e.paddingSize,a=e.borderSize,o=e.sizingStyle,s=o.boxSizing;Object.keys(o).forEach((function(e){var t=e;D.style[t]=o[t]})),Q(D),D.value=t;var l=X(D,e);D.value=t,l=X(D,e),D.value="x";var c=D.scrollHeight-i,d=c*n;"border-box"===s&&(d=d+i+a),l=Math.max(d,l);var u=c*r;return"border-box"===s&&(u=u+i+a),[l=Math.min(u,l),c]}(t,e.value||e.placeholder||"x",i,r),o=a[0],s=a[1];h.current!==o&&(h.current=o,e.style.setProperty("height",o+"px","important"),l(o,{rowHeight:s}))}};return v.useLayoutEffect(f),function(e,t){J(document.body,"reset",(function(n){e.current.form===n.target&&t(n)}))}(u,(function(){if(!d){var e=u.current,t=e.value;requestAnimationFrame((function(){t!==e.value&&f()}))}})),J(window,"resize",f),function(e){J(document.fonts,"loadingdone",e)}(f),v.createElement("textarea",z({},c,{onChange:function(e){d||f(),o(e)},ref:p}))},te=v.forwardRef(ee),ne=(o=a("1Tjc3"),v=a("2q4iO"),a("a5i9T"));const re=({text:e,cta1:t,cta1LinkFn:n,cta2:r,cta2LinkFn:i,isShow:a,setShow:s,setHide:l,userId:c})=>{const d="premium-cta",u=a?{onClick:l}:{onMouseEnter:s,onClick:s,onFocus:s};return(0,v.useEffect)((()=>{let e,t;return a&&(e=e=>{!!e.target.closest(`.${d}`)||l()},t=e=>{27===e.keyCode&&l()},document.documentElement.addEventListener("click",e,!1),document.documentElement.addEventListener("keyup",t,!1)),()=>{e&&document.documentElement.removeEventListener("click",e,!1),t&&document.documentElement.removeEventListener("keyup",t,!1)}}),[a,l]),(0,o.jsxs)("span",{className:d,children:[(0,o.jsx)("span",{tabIndex:"0",className:"premium-cta--icon",...u,children:"?"}),a&&(0,o.jsxs)("span",{className:"premium-cta--tooltip",children:[e,!1,t&&n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("br",{}),(0,o.jsx)("a",{href:n(),children:t}),!c&&r&&i&&(0,o.jsxs)(o.Fragment,{children:[" or ",(0,o.jsx)("a",{href:i(),children:r})]})]})]})]})};re.displayName="PremiumCta";var ie=re;const ae=({field:e,value:n,onChange:r,isSubOk:i,userId:a})=>{const s=e.premiumInfo,l=!i&&!!s;l&&(n=s.basicDefault);const[c,d]=(0,v.useState)(!1),u=()=>d(!0),p=e=>{const t=e.currentTarget,n=t.name;if(l)u();else{const e=A(t);r(n,e)}};let h;switch(e.type){case"bool":h=(0,o.jsx)("div",{className:"options-ctrl",children:(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{className:"options-input",type:"checkbox",name:e.name,checked:n,onChange:p}),(0,o.jsx)("span",{className:"label-text",children:e.label})]})});break;case"text":h=(0,o.jsxs)("div",{className:"options-ctrl flex-wrapper",children:[(0,o.jsx)("label",{children:e.label}),"textarea"===e.width?(0,o.jsx)(te,{className:"options-input",name:e.name,style:{resize:"none"},value:n,onChange:p}):(0,o.jsx)("input",{className:"options-input",type:"text",name:e.name,value:n,onChange:p,disabled:e.disabled})]});break;case"choice":h=(0,o.jsxs)("div",{className:"options-ctrl flex-wrapper",children:[(0,o.jsx)("label",{children:e.label}),(0,o.jsx)("select",{className:"options-input",name:e.name,value:n,onChange:p,children:e.convertedChoices.map((e=>(0,o.jsx)("option",{value:e.key,children:e.display||e.key},e.key)))})]});break;default:throw new Error(`unsupported type! ${e.type}`)}const m=(0,o.jsxs)("span",{className:"help",children:[e.help&&"function"==typeof e.help?e.help(n):e.help||"",l&&(0,o.jsxs)(o.Fragment,{children:[" ",(0,o.jsx)(ie,{...s,isShow:c,setShow:u,setHide:()=>d(!1),userId:a})]}),(0,o.jsx)("span",{className:"msg"})]});return(0,o.jsxs)("div",{className:t(g)("options-elt",`type-${e.type}`),children:[h,m]})};ae.displayName="OptionField",ae.propTypes={field:t(M).shape({name:t(M).string.isRequired,type:t(M).oneOf(["choice","bool","text"]),group:t(M).string.isRequired,default:t(M).any,label:t(M).string.isRequired,help:t(M).string,validate:t(M).func,hidden:t(M).bool,premiumInfo:t(M).shape({text:t(M).string.isRequired,cta1:t(M).string,cta1LinkFn:t(M).func,cta2:t(M).string,cta2LinkFn:t(M).func,basicDefault:t(M).any.isRequired})}).isRequired,value:t(M).any,onChange:t(M).func.isRequired,isSubOk:t(M).bool.isRequired,userId:t(M).string};var oe=ae,se=(o=a("1Tjc3"),v=a("2q4iO"),a("1BBN9")),le=(a("iMjBX"),R=a("2xkva"),a("830oE"));se=a("1BBN9"),j=a("iMjBX"),ne=a("a5i9T"),k=a("7i7LO");const ce=[{id:"downloads",perms:se.PERMISSIONS.DOWNLOADS,name:(0,j.tr)("Downloads permission"),help_text:(0,j.tr)("This permission is required for the download buttons and the auto-download feature."),on_revoke:function(){k.default.remove("auto_dl2")}}];(0,ne.noIframes)()||ce.push({id:"iframe",perms:le.FRAME_PERMS,permsContains:le.FRAME_PERMS_CONTAINS,name:(0,j.tr)("iFrame permission"),help_html:(0,j.tr)("This permission is required in order to scroll the inner contents of $iframes$ or $framesets$.",null,[],{iframes:{content:'<a class="dim" target="_blank" rel="noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe">iframes</a>',example:"iframes"},framesets:{content:'<a class="dim" target="_blank" rel="noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/frameset">framesets</a>',example:"framesets"}})});o=a("1Tjc3");a("2q4iO");se=a("1BBN9");const de=({tog:e,value:t,onChange:n})=>(0,o.jsxs)("div",{className:"perm-row cb-row",children:[(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{className:"cb-input",type:"checkbox",name:e.id,checked:t||!1,disabled:void 0===t,onChange:t=>{t.currentTarget.checked?se.request(e.perms).then((t=>{t?(_("notif-sav"),n(e.id,!0)):_("notif-err")})).catch(q):se.remove(e.perms).then((t=>{t?(e.on_revoke&&e.on_revoke(),_("notif-sav"),n(e.id,!1)):_("notif-err")})).catch(q)}}),(0,o.jsx)("span",{className:"cb-text",children:e.name})]}),e.help_text?(0,o.jsx)("div",{className:"cb-help",children:e.help_text}):e.help_html?(0,o.jsx)("div",{className:"cb-help",dangerouslySetInnerHTML:{__html:e.help_html}}):null]});de.displayName="ToggleElt";var ue=de;const pe=()=>{const[e,n]=(0,v.useState)({}),[r,i]=(0,v.useState)(!1),a=e=>n((t=>({...t,...e})));(0,v.useEffect)((()=>{ce.map((e=>{se.contains(e.permsContains||e.perms).then((t=>{a({[e.id]:t})})).catch((e=>R.default.error(e)))}))}),[]);const s=(e,t)=>{a({[e]:t})};return(0,o.jsxs)("div",{className:"container",id:"perm-settings-container",children:[(0,o.jsx)("p",{children:(0,o.jsx)("a",{href:"",className:"perm-header dim",id:"perm-toggle",onClick:e=>{e.preventDefault(),i(!r)},children:(0,o.jsxs)("strong",{children:[(0,j.tr)("Permissions"),(0,o.jsx)("span",{className:t(g)("arrow",{"pe-7s-angle-down":!r,"pe-7s-angle-up":r})})]})})}),r&&(0,o.jsxs)("div",{id:"perm-content",children:[(0,o.jsx)("p",{children:(0,j.tr)("Any optional permissions that were previously granted will appear checked here. You can revoke them at any time. If they are needed again in the future, they will be re-requested.")}),ce.map((t=>(0,o.jsx)(ue,{tog:t,value:e[t.id],onChange:s},t.id)))]})]})};pe.displayName="ToggleElts";var he=pe;const me=()=>{const[e,n]=(0,v.useState)(null),[r,i]=(0,v.useState)({}),[a,s]=(0,v.useState)(null),c=e=>n((t=>({...t,...e})));(0,v.useEffect)((()=>{E.default.pageview(),O(!0),(0,j.updateHtml)(),S.update(),Array.prototype.slice.call(document.querySelectorAll("a[data-href]")).forEach((e=>{e.href=e.dataset.href})),(0,l.$)("version-num").innerText=(0,C.getVersion)();const e=(0,y.makeLoginUrl)();l.$.findClass("account-url").forEach((t=>{t.setAttribute("href",e),t.style.display=""})),b.default.loginStateProm(!0).then((e=>{s(e)})),k.default.onUpdate((e=>{const t={};e.forEach((e=>{t[e]=k.default.state[e]})),c(t)})),k.default.load().then((e=>{n(e)}))}),[]),(0,v.useEffect)((()=>{if(w.REGISTER_SELF_URL){const e=document.getElementById("opts-menu-right");e||alert("Missing opts-menu-right wrapper!");const t=document.createElement("a");Object.assign(t.style,{display:"inline-block",marginRight:"20px",color:"#ef4444"}),t.textContent="Connect backend",t.target="_blank",t.href=`${w.REGISTER_SELF_URL}?id=${encodeURIComponent(chrome.runtime.id)}`,e.prepend(t),t.addEventListener("click",(e=>{e.shiftKey&&window.setTimeout((()=>{t.parentNode.removeChild(t)}))}),!1)}}),[]);const d=(e,t)=>{const n=k.default.getField(e);let a="";var o;n.process&&({val:t,msg:a}=n.process(t)),a&&r[e]!==a&&(o={[e]:a},i((e=>({...e,...o}))));(n.validate||T.PromiseTrue)(t).then((n=>n?(c({[e]:t}),k.default.set(e,t).then((()=>{_("notif-sav")}))):void 0)).catch((e=>{q(e)}))};if(!e)return(0,o.jsx)("div",{className:"container",id:"settings-container",children:(0,j.tr)("loading…")});const u=a&&a.userId||null,p=!!a&&"sub-ok"===a.subState,h=a&&a.store&&a.store.show_experimental||!1,m=L(Object.entries(k.default.fields).map((([t,n])=>(0,x.isFieldHidden)(n,p,e)?null:{...n,name:t})).filter((e=>e)),"group");return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"container",id:"settings-container",children:m.map((({key:n,vals:r},i)=>(0,o.jsxs)("div",{className:"options-group",children:[(0,o.jsx)("h3",{children:n}),(0,o.jsx)("div",{className:t(g)("options-list",{last:i===m.length-1}),children:r.map((t=>t.experimental&&!h?null:(0,o.jsx)(oe,{field:t,value:e[t.name],onChange:d,userId:u,isSubOk:p},t.name)))})]},n)))}),(0,o.jsx)(he,{})]})};me.displayName="App";var fe=me;!function(){const e=d(),t=e.editor||e.capture||e.history;t&&l.$.findClass("back-button").forEach((e=>{-1===e.getAttribute("href").indexOf("?")&&(e.removeAttribute("data-href"),e.href=t)})),u((0,l.$)("btn-settings"),e.options),u((0,l.$)("btn-history"),e.history)}(),(0,s.render)((0,o.jsx)(fe,{}),document.getElementById("root"));
//# sourceMappingURL=options.8a27e09e.js.map
